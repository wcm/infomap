(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{104:function(t,e,a){t.exports=a(216)},154:function(t,e,a){},176:function(t,e,a){},191:function(t,e){},193:function(t,e){},204:function(t){t.exports={"POI Map":{title:"Display:",options:["None","Short Links","Long Links"]},"Nolli Map":{title:"Coloring Mode:",options:["None","Height","Program"]},Traffic:{title:"Display:",options:["Both","Roads","Public Transport"]}}},205:function(t,e,a){},208:function(t,e,a){},211:function(t,e,a){},216:function(t,e,a){"use strict";a.r(e);var i=a(0),n=a.n(i),o=a(60),s=a.n(o),r=a(223),l=a(222);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var c=a(61),p=a(5),h=a(4),d=a(7),u=a(6),m=a(8),g=a(220),f=a(45),v=a(100),b=a.n(v),y=a(221),w=a(33),E=function(t){function e(t){var a;return Object(p.a)(this,e),(a=Object(d.a)(this,Object(u.a)(e).call(this,t))).updateWindowDimensions=function(){a.setState({width:a.container.offsetWidth,height:a.container.offsetHeight})},a.updateXY=function(t,e,i){var n=i.deltaX,o=i.deltaY,s=a.state.mouseX,r=a.state.mouseY;"1"===t?(s+=n,r+=o):"2"===t?(s-=n,r+=o):"3"===t?(s+=n,r-=o):"4"===t&&(s-=n,r-=o),s>=40&&s<=a.state.width/2-40&&r>=60&&r<=a.state.height/2-40&&a.props.setXY({x:s,y:r}),a.setState({mouseX:s,mouseY:r})},a.handleStart=function(t,e,i){var n=i.deltaX,o=i.deltaY;a.props.setDragging(!0),a.updateXY(t,e,{deltaX:n,deltaY:o})},a.handleStop=function(t,e,i){var n=i.deltaX,o=i.deltaY;a.props.setDragging(!1),a.updateXY(t,e,{deltaX:n,deltaY:o}),a.setState({mouseX:a.props.x,mouseY:a.props.y})},a.handleDrag=function(t,e,i){var n=i.deltaX,o=i.deltaY;a.updateXY(t,e,{deltaX:n,deltaY:o})},a.state={width:0,height:0,dragging:!1,mouseX:a.props.x,mouseY:a.props.y},a}return Object(m.a)(e,t),Object(h.a)(e,[{key:"componentDidMount",value:function(){this.updateWindowDimensions(),window.addEventListener("resize",this.updateWindowDimensions)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.updateWindowDimensions)}},{key:"render",value:function(){var t=this,e=this.state.width,a=this.state.height;return n.a.createElement("div",{className:"selector",ref:function(e){return t.container=e}},n.a.createElement("div",{className:"shader",style:{position:"absolute",left:0,top:0,height:"".concat(a,"px"),width:"".concat(this.props.x,"px")}}),n.a.createElement("div",{className:"shader",style:{position:"absolute",left:"".concat(e-this.props.x,"px"),top:0,height:"".concat(a,"px"),width:"".concat(this.props.x,"px")}}),n.a.createElement("div",{className:"shader",style:{position:"absolute",left:"".concat(this.props.x,"px"),top:0,height:"".concat(this.props.y,"px"),width:"".concat(e-2*this.props.x,"px")}}),n.a.createElement("div",{className:"shader",style:{position:"absolute",left:"".concat(this.props.x,"px"),top:"".concat(a-this.props.y,"px"),height:"".concat(this.props.y,"px"),width:"".concat(e-2*this.props.x,"px")}}),n.a.createElement(w.DraggableCore,{onStart:this.handleStart.bind(this,"1"),onDrag:this.handleDrag.bind(this,"1"),onStop:this.handleStop.bind(this,"1")},n.a.createElement("div",{className:"handler",style:{top:this.props.y-6,left:this.props.x-6}})),n.a.createElement(w.DraggableCore,{onStart:this.handleStart.bind(this,"2"),onDrag:this.handleDrag.bind(this,"2"),onStop:this.handleStop.bind(this,"2")},n.a.createElement("div",{className:"handler",style:{top:this.props.y-6,left:e-this.props.x-6}})),n.a.createElement(w.DraggableCore,{onStart:this.handleStart.bind(this,"3"),onDrag:this.handleDrag.bind(this,"3"),onStop:this.handleStop.bind(this,"3")},n.a.createElement("div",{className:"handler",style:{top:a-this.props.y-6,left:this.props.x-6}})),n.a.createElement(w.DraggableCore,{onStart:this.handleStart.bind(this,"4"),onDrag:this.handleDrag.bind(this,"4"),onStop:this.handleStop.bind(this,"4")},n.a.createElement("div",{className:"handler",style:{top:a-this.props.y-6,left:e-this.props.x-6}})))}}]),e}(i.Component),k=(a(154),"pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4M29iazA2Z2gycXA4N2pmbDZmangifQ.-g_vE53SD2WrJ6tFX7QHmA"),x=function(t){function e(t){var a;Object(p.a)(this,e),(a=Object(d.a)(this,Object(u.a)(e).call(this,t))).resize=function(){var t=a.state.viewport,e=a.state.selector;window.innerWidth>768?(a.state.sidebar&&a.setState({sidebar:!1}),t.width=window.innerWidth-250,t.height=window.innerHeight):(t.width=window.innerWidth,t.height=window.innerHeight-60),e.x=t.width/4,e.y=t.height/4,a.setState({viewport:t,selector:e,width:t.width,height:t.height}),a.handleViewportChange(t)},a.initialLocation=function(){a.setLocation(),clearInterval(a.interval)},a.handleViewportChange=function(t){if(!1===a.state.isdragging&&(a.setState({viewport:Object(c.a)({},a.state.viewport,t,{transitionDuration:100}),input:{longitude:t.longitude.toFixed(4),latitude:t.latitude.toFixed(4),zoom:t.zoom}}),a.mapRef.current)){var e=a.mapRef.current.getMap().getBounds();a.setState({selBounds:{n:e._ne.lat,s:e._sw.lat,w:e._sw.lng,e:e._ne.lng}})}},a.handleOnResult=function(t){},a.handleGeocoderViewportChange=function(t){a.handleViewportChange(Object(c.a)({},t,{transitionDuration:500}))},a.setDragging=function(t){a.setState({isdragging:t})},a.setXY=function(t){a.setState({selector:t})},a.getDistance=function(t,e,a,i){var n=t*Math.PI/180,o=a*Math.PI/180,s=(a-t)*Math.PI/180,r=(i-e)*Math.PI/180,l=Math.sin(s/2)*Math.sin(s/2)+Math.cos(n)*Math.cos(o)*Math.sin(r/2)*Math.sin(r/2);return 6371e3*(2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l)))},a.getBoundArea=function(t,e,i,n){return a.getDistance(t,i,t,n)*a.getDistance(t,i,e,i)},a.setLocation=function(){var t=parseFloat(document.getElementById("longitude").value),e=parseFloat(document.getElementById("latitude").value),i=parseFloat(document.getElementById("zoom").value);a.handleViewportChange({longitude:t,latitude:e,zoom:i})},a.changeInputValue=function(t,e){var i=a.state.input;i[t]=e.target.value,a.setState({input:i})},a.expandSidebar=function(){a.setState({sidebar:!0})},a.foldSidebar=function(){a.setState({sidebar:!1})};var i=48.13832,o=11.5744;return a.props.match.params.lat&&a.props.match.params.lng&&(o=parseFloat(a.props.match.params.lng),i=parseFloat(a.props.match.params.lat)),a.state={viewport:{width:window.innerWidth-250,height:window.innerHeight,longitude:o,latitude:i,zoom:15,bearing:0,pitch:0},input:{longitude:o.toFixed(4),latitude:i.toFixed(4),zoom:15},selector:{x:(window.innerWidth-250)/4,y:window.innerHeight/4},isdragging:!1,selBounds:{n:0,s:0,w:0,e:0},width:window.innerWidth-250,height:window.innerHeight,sidebar:!1},a.mapRef=n.a.createRef(),a}return Object(m.a)(e,t),Object(h.a)(e,[{key:"componentDidMount",value:function(){var t=this;window.addEventListener("resize",this.resize),this.resize(),this.interval=setInterval(function(){return t.initialLocation()},1)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.resize)}},{key:"render",value:function(){var t=this,e=this.state,a=e.viewport,i=e.selector,o=e.selBounds,s=o.n-i.y/a.height*(o.n-o.s),r=o.s+i.y/a.height*(o.n-o.s),l=o.w+i.x/this.state.width*(o.e-o.w),c=o.e-i.x/this.state.width*(o.e-o.w),p=this.getBoundArea(s,r,l,c).toFixed(2),h=0;h=p<=4e6?210*Math.sqrt(p/4e6):210*Math.sqrt(4e6/p);var d={left:0};return window.innerWidth<768&&!this.state.sidebar&&(d={left:-250}),n.a.createElement("div",{className:"content"},n.a.createElement("div",{className:"select-wrapper",ref:function(e){return t.container=e}},n.a.createElement(f.default,Object.assign({className:"map",ref:this.mapRef},a,{onViewportChange:this.handleViewportChange,mapboxApiAccessToken:k,mapStyle:"mapbox://styles/mapbox/streets-v9"}),n.a.createElement(b.a,{mapRef:this.mapRef,onResult:this.handleOnResult,onViewportChange:this.handleGeocoderViewportChange,mapboxApiAccessToken:k,position:"top-right"}),n.a.createElement("div",{className:"control"},n.a.createElement(f.NavigationControl,{showCompass:!1,onViewportChange:this.handleViewportChange})),n.a.createElement(E,Object.assign({},i,{setDragging:this.setDragging,setXY:this.setXY})))),n.a.createElement("div",{className:"sidebar-main-wrapper",style:d},n.a.createElement("div",{className:"footer-wrapper"},n.a.createElement("img",{className:"logo",src:"/infomap/image/infomap-logo.svg",alt:"infomap"}),n.a.createElement("div",{className:"coordinates"},n.a.createElement("div",{className:"parameter"},"Longitude:",n.a.createElement("input",{type:"number",id:"longitude",step:"0.0001",min:"-180",max:"180",value:this.state.input.longitude,onChange:function(e){return t.changeInputValue("longitude",e)}})),n.a.createElement("div",{className:"parameter"},"Latitude:",n.a.createElement("input",{type:"number",id:"latitude",step:"0.0001",min:"-90",max:"90",value:this.state.input.latitude,onChange:function(e){return t.changeInputValue("latitude",e)}})),n.a.createElement("div",{className:"parameter"},"Zoom:",n.a.createElement("input",{type:"number",id:"zoom",step:"0.0001",min:"-90",max:"90",value:this.state.input.zoom,onChange:function(e){return t.changeInputValue("zoom",e)}})),n.a.createElement("div",{className:"button-secondary",onClick:this.setLocation},"Go to location")),p<=4e6?n.a.createElement("div",{className:"area"},n.a.createElement("div",{className:"area-indicator"},n.a.createElement("div",{className:"area-indicator-fill",style:{width:h,height:h,top:(210-h)/2,left:(210-h)/2}}),n.a.createElement("div",{className:"limit"},"4 km\xb2")),n.a.createElement("div",{className:"area-number"},"Area: ",p," m\xb2"),n.a.createElement(g.a,{to:"".concat("/infomap","/selected/").concat(l,"/").concat(r,"/").concat(c,"/").concat(s)},n.a.createElement("div",{className:"button proceed-button"},"Proceed to Analysis "))):n.a.createElement("div",{className:"area"},n.a.createElement("div",{className:"area-indicator-exceed"},n.a.createElement("div",{className:"area-indicator-fill-exceed",style:{width:h,height:h,top:(210-h)/2,left:(210-h)/2}}),n.a.createElement("div",{className:"limit-exceed",style:{top:(210-h)/2+8,right:(210-h)/2+8}},"4 km\xb2")),n.a.createElement("div",{className:"area-number"},"Area: > 4 km\xb2"),n.a.createElement("div",{className:"button button-disabled proceed-button"},"Proceed to Analysis "),n.a.createElement("div",{className:"proceed-alert"}," Selected area must be smaller than 4 km\xb2 ")),n.a.createElement("div",{className:"raw hide"},n.a.createElement("div",null,n.a.createElement("p",null,"Viewport Coordinates:"),n.a.createElement("p",null," ","n: ".concat(o.n," s: ").concat(o.s," w: ").concat(o.w," e: ").concat(o.e))),n.a.createElement("div",null,n.a.createElement("p",null,"Selected Region Coordinates:"),n.a.createElement("p",null," ","n: ".concat(s," s: ").concat(r," w: ").concat(l," e: ").concat(c))),n.a.createElement("div",null,n.a.createElement("p",null,"Selected Region Area:"),n.a.createElement("p",null," ",p))),n.a.createElement("div",{className:"push"})),n.a.createElement("div",{className:"sidebar-footer"},n.a.createElement("div",{className:"footer-tab"},"About"),n.a.createElement("div",{className:"footer-tab"},"Help"))),n.a.createElement("div",{className:"navbar"},n.a.createElement("img",{className:"icon",src:"/infomap/image/icon/menu.svg",onClick:this.expandSidebar,alt:"menu"}),n.a.createElement("img",{className:"logo",src:"/infomap/image/infomap-logo.svg",alt:"infomap"})),n.a.createElement("div",{className:this.state.sidebar?"mask":"hide",onClick:this.foldSidebar}))}}]),e}(i.Component),N=Object(y.a)(x),M=function(t){function e(){return Object(p.a)(this,e),Object(d.a)(this,Object(u.a)(e).apply(this,arguments))}return Object(m.a)(e,t),Object(h.a)(e,[{key:"render",value:function(){return n.a.createElement("div",null,n.a.createElement("div",null,"Help"))}}]),e}(n.a.Component),O=function(t){function e(){return Object(p.a)(this,e),Object(d.a)(this,Object(u.a)(e).apply(this,arguments))}return Object(m.a)(e,t),Object(h.a)(e,[{key:"render",value:function(){return n.a.createElement("div",null,n.a.createElement("div",null,"About"))}}]),e}(n.a.Component),S=a(103),j=a.n(S),L=(a(176),a(50)),C=function(t){function e(){return Object(p.a)(this,e),Object(d.a)(this,Object(u.a)(e).apply(this,arguments))}return Object(m.a)(e,t),Object(h.a)(e,[{key:"render",value:function(){var t=this,e=this.props,a=e.pie,i=e.innerRadius,o=e.outerRadius,s=e.cornerRadius,r=e.padAngle,l=e.styles,c=L.a().innerRadius(i).outerRadius(o).cornerRadius(s).padAngle(r),p=L.b("#eaaf79","#bc3358");return a.map(function(e,i){p(i/(a.length-1));return n.a.createElement("g",{key:i},n.a.createElement("path",{d:c(e),fill:l[i].fill}),n.a.createElement("text",{transform:"translate(".concat(c.centroid(e)[0],", ").concat(c.centroid(e)[1],")"),dy:".35em",color:"grey"},t.props.tags[i]))})}}]),e}(n.a.Component),W=function(t){function e(t){return Object(p.a)(this,e),Object(d.a)(this,Object(u.a)(e).call(this,t))}return Object(m.a)(e,t),Object(h.a)(e,[{key:"render",value:function(){var t=this.props,e=t.data,a=t.innerRadius,i=t.outerRadius,o=t.cornerRadius,s=t.padAngle,r=t.styles,l=L.c()(e);return n.a.createElement("svg",{height:200,width:200},n.a.createElement("g",{transform:"translate(".concat(100,",").concat(100,")")},n.a.createElement(C,{innerRadius:a,outerRadius:i,cornerRadius:o,padAngle:s,styles:r,pie:l,tags:this.props.tags})))}}]),e}(n.a.Component),T=function(t){function e(t){var a;return Object(p.a)(this,e),(a=Object(d.a)(this,Object(u.a)(e).call(this,t))).getBuildingCat=function(t){var e=5;return[["apartments","farm","hotel","house","detached","residential","dormitory","terrace","houseboat","bungalow","static_caravan","cabin"],["commercial","office","industrial","retail","supermarket","warehouse","kiosk"],["religious","cathedral","chapel","church","mosque","temple","synagogue","shrine"],["bakehouse","kindergarten","civic","government","hospital","school","stadium","train_station","transportation","university","grandstand","public","toilets","service","parking","garages","garage","sports_hall","bridge","\tcarport","hangar"],["greenhouse","pavilion","farm_auxiliary","barn"]].forEach(function(a,i){-1!==a.indexOf(t)&&(e=i)}),e},a.showTooltip=function(t,e){var i=e.target.getBBox();i.x+i.width/2>=a.props.width/2?a.setState({left:!0}):a.setState({left:!1}),a.setState({tooltip:!0,info:t})},a.hideTooltip=function(){a.setState({tooltip:!1,info:{}})},a.state={tooltip:!1,info:{},left:!0},a}return Object(m.a)(e,t),Object(h.a)(e,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var t=[],e=this.props,a=e.width,i=e.height,o=e.ways,s=e.relations,r=this.state.info,l=0,c=[0,0,0,0,0,0],p=[0,0,0,0,0,0],h=[{fill:"#ad4a00"},{fill:"#7693d3"},{fill:"#0053cc"},{fill:"#cb00d1"},{fill:"#b6ff97"},{fill:"rgba(60, 60, 60)"},{fill:"rgba(52, 168, 0, .4)"}],d=-1,u=null,m="rgba(60, 60, 60)";for(var g in s)if(s[g].tag.building||s[g].tag["buidling:part"]){var f="";m="rgba(60,60,60)",s[g].members.forEach(function(t){if("way"===t.type&&t.value){var e=t.value.map(function(t){return t.join(",")}).join(" ");f+="M ".concat(e)}}),u=s[g].tag["building:levels"],d=this.getBuildingCat(s[g].tag.building),"Height"===this.props.option?u?(m="rgba(0,0,255,".concat(u/10,")"),t.push(n.a.createElement("path",{d:f,fillRule:"evenodd",fill:m,stroke:"white",strokeWidth:".5",key:g,className:"nolli-building",onMouseEnter:this.showTooltip.bind(this,s[g].tag),onMouseLeave:this.hideTooltip.bind(this)},n.a.createElement("title",null,g)))):t.unshift(n.a.createElement("path",{d:f,fillRule:"evenodd",fill:m,stroke:"white",strokeWidth:".5",key:g,className:"nolli-building",onMouseEnter:this.showTooltip.bind(this,s[g].tag),onMouseLeave:this.hideTooltip.bind(this)},n.a.createElement("title",null,g))):"Program"===this.props.option?t.push(n.a.createElement("path",{d:f,fillRule:"evenodd",fill:h[d].fill,stroke:"white",strokeWidth:".5",key:g,className:"nolli-building",onMouseEnter:this.showTooltip.bind(this,s[g].tag),onMouseLeave:this.hideTooltip.bind(this)},n.a.createElement("title",null,g))):"None"===this.props.option&&t.push(n.a.createElement("path",{d:f,fillRule:"evenodd",fill:m,stroke:"white",strokeWidth:".5",key:g,className:"nolli-building",onMouseEnter:this.showTooltip.bind(this,s[g].tag),onMouseLeave:this.hideTooltip.bind(this)},n.a.createElement("title",null,g))),l+=parseFloat(s[g].tag.footprint),c[d]+=parseFloat(s[g].tag.footprint),parseFloat(s[g].tag.footprint)*u,p[d]+=parseFloat(s[g].tag.footprint)*u}for(g in o)if(o[g].tag.building){var v=o[g].points.map(function(t){return t.join(",")}).join(" ");m="rgba(60,60,60)",u=o[g].tag["building:levels"],d=this.getBuildingCat(o[g].tag.building),"Height"===this.props.option?u?(m="rgba(0,0,255,".concat(u/10,")"),t.push(n.a.createElement("polygon",{points:v,fill:m,stroke:"white",strokeWidth:".5",key:g,className:"nolli-building",onMouseEnter:this.showTooltip.bind(this,o[g].tag),onMouseLeave:this.hideTooltip.bind(this)}))):t.unshift(n.a.createElement("polygon",{points:v,fill:m,stroke:"white",strokeWidth:".5",key:g,className:"nolli-building",onMouseEnter:this.showTooltip.bind(this,o[g].tag),onMouseLeave:this.hideTooltip.bind(this)})):"Program"===this.props.option?t.push(n.a.createElement("polygon",{points:v,fill:h[d].fill,stroke:"white",strokeWidth:".5",key:g,className:"nolli-building",onMouseEnter:this.showTooltip.bind(this,o[g].tag),onMouseLeave:this.hideTooltip.bind(this)})):"None"===this.props.option&&t.push(n.a.createElement("polygon",{points:v,fill:m,stroke:"white",strokeWidth:".5",key:g,className:"nolli-building",onMouseEnter:this.showTooltip.bind(this,o[g].tag),onMouseLeave:this.hideTooltip.bind(this)})),l+=parseFloat(o[g].tag.footprint),c[d]+=parseFloat(o[g].tag.footprint),parseFloat(o[g].tag.footprint)*u,p[d]+=parseFloat(o[g].tag.footprint)*u}var b=this.props.width*this.props.height/this.props.lengthratio/this.props.lengthratio-l,y=[];for(var w in r)if("building"!==w||"yes"!==r[w]){var E=w.charAt(0).toUpperCase()+w.substr(1).toLowerCase();y.push(n.a.createElement("div",{className:"tooltip-info",key:w},n.a.createElement("span",{className:"tooltip-key"},E,": "),r[w]," ","Footprint"===E?decodeURI("m%C2%B2"):""))}var k={};k=this.state.left?{top:"0",left:"0"}:{top:"0",right:"0"};return console.log(c),n.a.createElement("div",{className:"nollimap"},n.a.createElement("svg",{version:"1.1",viewBox:"0 0 ".concat(a," ").concat(i)},t),0!=l?n.a.createElement("div",{className:"charts"},n.a.createElement(W,{title:"Building footprint",tags:["Built","Unbuilt"],height:0,innerRadius:21,outerRadius:60,cornerRadius:2,padAngle:.02,data:[l,b],styles:[{fill:"rgba(60, 60, 60)"},{fill:"rgba(200, 200, 200)"}]}),n.a.createElement(W,{title:"Total floor area by program",tags:["Residential","Commercial","Religious","Civic","Others","Unknown"],height:0,innerRadius:21,outerRadius:60,cornerRadius:2,padAngle:.02,data:c,styles:h})):n.a.createElement("div",null),n.a.createElement("div",{className:this.state.tooltip?"tooltip":"hide",style:k},n.a.createElement("div",{className:"tooltip-title"},"Building Details"),y))}}]),e}(n.a.Component),D=function(t){function e(t){var a;return Object(p.a)(this,e),(a=Object(d.a)(this,Object(u.a)(e).call(this,t))).showTooltip=function(t,e){var i=e.target.getBBox();i.x+i.width/2>=a.props.width/2?a.setState({left:!0}):a.setState({left:!1}),a.setState({tooltip:!0,info:t})},a.hideTooltip=function(){a.setState({tooltip:!1,info:{}})},a.getWayCat=function(t){var e=5;return[["motorway","trunk","motorway_link","trunk_link"],["primary","primary_link"],["secondary","tertiary","secondary_link","tertiary_link","raceway"],["unclassified","residential","living_street","road","escape"],["service","pedestrian","track","bus_guideway","footway","bridleway","steps","path","cycleway"]].forEach(function(a,i){-1!==a.indexOf(t)&&(e=i)}),e},a.state={tooltip:!1,info:{},left:!0},a}return Object(m.a)(e,t),Object(h.a)(e,[{key:"render",value:function(){var t=this,e=[[],[],[],[],[],[]],a=this.props,i=a.width,o=a.height,s=a.ways,r=a.relations,l=this.props.lengthratio,c=this.state.info,p=[{color:"#b5451a",strokeWidth:"16"},{color:"#f15c22",strokeWidth:"10"},{color:"#f47d4e",strokeWidth:"8"},{color:"#f79d7a",strokeWidth:"5"},{color:"#f9bea7",strokeWidth:"2"},{color:"#fcded3",strokeWidth:"4"}],h=-1,d={};for(var u in s)if(s[u].tag.highway&&("Roads"===this.props.option||"Both"===this.props.option)){var m=s[u].points.map(function(t){return t.join(",")}).join(" ");d=p[h=this.getWayCat(s[u].tag.highway)],e[5-h].push(n.a.createElement("path",{d:"M ".concat(m),fill:"none",stroke:d.color,strokeWidth:d.strokeWidth*l,strokeLinecap:"round",strokeLinejoin:"round",key:u+"w",onMouseEnter:this.showTooltip.bind(this,s[u].tag),onMouseLeave:this.hideTooltip.bind(this)},n.a.createElement("title",null,u)))}for(u in r)if(!r[u].tag.route||"Public Transport"!==this.props.option&&"Both"!==this.props.option){if(r[u].tag.highway&&("Roads"===this.props.option||"Both"===this.props.option)){var g="";r[u].members.forEach(function(t){if("way"===t.type&&t.value){var e=t.value.map(function(t){return t.join(",")}).join(" ");g+="M ".concat(e)}}),d=p[h=this.getWayCat(r[u].tag.highway)],e[5-h].push(n.a.createElement("path",{d:g,fillRule:"evenodd",fill:d.color,stroke:"none",key:u,className:"nolli-building",onMouseEnter:this.showTooltip.bind(this,r[u].tag),onMouseLeave:this.hideTooltip.bind(this)},n.a.createElement("title",null,u)))}}else r[u].members.forEach(function(a,i){if("way"===a.type&&a.value){var o=a.value.map(function(t){return t.join(",")}).join(" ");"platform"===a.role?e.push(n.a.createElement("path",{d:"M ".concat(o),fill:"red",stroke:"red",strokeWidth:"1",key:i.toString()+u,onMouseEnter:t.showTooltip.bind(t,r[u].tag),onMouseLeave:t.hideTooltip.bind(t)},n.a.createElement("title",null,u))):e.push(n.a.createElement("path",{d:"M ".concat(o),fill:"none",stroke:"red",strokeWidth:"1",key:i.toString()+u,onMouseEnter:t.showTooltip.bind(t,r[u].tag),onMouseLeave:t.hideTooltip.bind(t)},n.a.createElement("title",null,u)))}else if("node"===a.type&&a.value){var s=50;"subway"!==r[u].tag.route&&"train"!==r[u].tag.route||(s=100),e.push(n.a.createElement("g",{key:i.toString()+u},n.a.createElement("circle",{cx:a.value[0],cy:a.value[1],r:s*l,fill:"rgba(255,90,90,.1)",onMouseEnter:t.showTooltip.bind(t,r[u].tag),onMouseLeave:t.hideTooltip.bind(t)},n.a.createElement("title",null,u)),n.a.createElement("circle",{cx:a.value[0],cy:a.value[1],r:"2",fill:"#803535",onMouseEnter:t.showTooltip.bind(t,r[u].tag),onMouseLeave:t.hideTooltip.bind(t)},n.a.createElement("title",null,u))))}});var f=[];for(var v in c){var b=v.charAt(0).toUpperCase()+v.substr(1).toLowerCase();f.push(n.a.createElement("div",{className:"tooltip-info",key:v},n.a.createElement("span",{className:"tooltip-key"},b,": "),c[v]," ","Footprint"===b?decodeURI("m%C2%B2"):""))}var y={};return y=this.state.left?{top:"0",left:"0"}:{top:"0",right:"0"},n.a.createElement("div",{className:"nollimap"},n.a.createElement("svg",{version:"1.1",viewBox:"0 0 ".concat(i," ").concat(o),style:{width:this.state.width}},e),n.a.createElement("div",{className:this.state.tooltip?"tooltip":"hide",style:y},n.a.createElement("div",{className:"tooltip-title"},"Route Details"),f))}}]),e}(n.a.Component);function R(t){return t*Math.PI/180}function _(t,e,a,i){return(a-t)*(a-t)+(i-e)*(i-e)}var P=a(179),A=P.intersect,B=P.shape,I=function(t){function e(t){var a;Object(p.a)(this,e),(a=Object(d.a)(this,Object(u.a)(e).call(this,t))).updatePos=function(t,e,i){var n=i.deltaX,o=i.deltaY,s=(a.props.humans[t][0]+n)/a.props.ratio,r=(a.props.humans[t][1]+o)/a.props.ratio;s>5&&s<a.props.width-5&&r>5&&r<a.props.height-5&&a.props.setPos(t,[a.props.humans[t][0]+n,a.props.humans[t][1]+o])},a.handleStart=function(t,e,i){var n=i.deltaX,o=i.deltaY;a.updatePos(t,e,{deltaX:n,deltaY:o}),a.props.setRegion(t,""),a.props.setArc(t,-1)},a.handleDrag=function(t,e,i){var n=i.deltaX,o=i.deltaY;a.updatePos(t,e,{deltaX:n,deltaY:o})},a.handleStop=function(t,e,i){var n=i.deltaX,o=i.deltaY;a.updatePos(t,e,{deltaX:n,deltaY:o}),a.props.setRegion(t,"M".concat(a.props.humans[t][0]/a.props.ratio,",").concat(a.props.humans[t][1]/a.props.ratio," ")),a.props.setArc(t,0)},a.showTooltip=function(t,e,i){var n=i.target.getBBox();if(n.x+n.width/2>=a.props.width/2?a.setState({left:!0}):a.setState({left:!1}),a.props.arcs[e]>=360){var o=t.substring(1,t.length-2).split(" "),s=[],r=[];o.forEach(function(t){r=t.split(","),s.push([parseFloat(r[0]),parseFloat(r[1])])});var l=function(t){var e=t,a=0;if(e.length<3)return 0;for(var i=0;i<e.length-1;i+=1)a+=e[i][0]*e[i+1][1]-e[i+1][0]*e[i][1];return Math.abs(1*a/2)}(s)/a.props.lengthratio/a.props.lengthratio;a.setState({tooltip:!0,info:"Visible Area: ".concat(l.toFixed(2)," ")+decodeURI("m%C2%B2"),shaded:t})}else a.setState({tooltip:!0,info:"Calculating area..."})},a.hideTooltip=function(){a.setState({tooltip:!1,info:"",shaded:""})},a.updateRegions=function(){var t=a.props.regions,e=a.props.arcs,i=!1;for(var n in e)if(e[n]<360&&-1!==e[n]){i=!0;var o=e[n],s=t[n];if(""===s&&(s="M".concat(a.props.humans[n][0]/a.props.ratio,",").concat(a.props.humans[n][1]/a.props.ratio," ")),o+a.angle>=360){var r=s.split(" ");r.shift(),s="M"+r.join(" ")+"Z"}else{var l=a.props.width,c=a.props.height,p=Math.max(l,c),h=a.props.humans[n][0]/a.props.ratio,d=a.props.humans[n][1]/a.props.ratio,u=A(B("line",{x1:h+p*Math.sin(R(o)),y1:d+p*Math.cos(R(o)),x2:h,y2:d}),B("path",{d:a.buildings})),m=u.points[0],g=_(0,0,l,c);m&&(g=_(h,d,m.x,m.y)),u.points.forEach(function(t){_(h,d,t.x,t.y)<g&&(g=_(h,d,t.x,t.y),m=t)}),s+="".concat(m.x,",").concat(m.y," ")}t[n]=s,e[n]=o+a.angle}i&&(a.props.setRegions(t),a.props.setArcs(e))},a.angle=2;var i="",n=a.props,o=n.ways,s=n.relations;for(var r in s)if(s[r].tag.building||s[r].tag["buidling:part"]){var l="";s[r].members.forEach(function(t){if("way"===t.type&&t.value){var e=t.value.map(function(t){return t.join(",")}).join(" ");l+="M ".concat(e)}}),i+=l}for(r in o)if(o[r].tag.building){var c=o[r].points.map(function(t){return t.join(",")}).join(" ");i+="M ".concat(c)}for(var h in i+="M 0,0 0,".concat(a.props.height," ").concat(a.props.width,",").concat(a.props.height," ").concat(a.props.width,",0 Z"),a.buildings=i,a.props.regions)""===a.props.regions[h]&&a.props.setRegion(h,"M".concat(a.props.humans[h][0]/a.props.ratio,",").concat(a.props.humans[h][1]/a.props.ratio," "));return a.state={tooltip:0,shaded:"",info:"",left:!0},a}return Object(m.a)(e,t),Object(h.a)(e,[{key:"componentDidMount",value:function(){var t=this;this.interval=setInterval(function(){return t.updateRegions()},5)}},{key:"componentWillUnmount",value:function(){clearInterval(this.interval)}},{key:"componentDidUpdate",value:function(t){if(t.ratio!==this.props.ratio)for(var e in this.props.humans)this.props.setPos(e,[this.props.humans[e][0]*this.props.ratio/t.ratio,this.props.humans[e][1]*this.props.ratio/t.ratio])}},{key:"render",value:function(){var t=this,e=["rgba(0, 255, 255, .4)","rgba(255, 139, 0, .4)","rgba(0, 139, 255, .2)","rgba(139, 255, 0, .2)","rgba(255, 0, 139, .2)","rgba(0, 255, 139, .2"],a=this.props.regions.map(function(a,i){return n.a.createElement("path",{d:a,fill:e[0],stroke:"red",strokeWidth:"1",key:i,onMouseEnter:t.showTooltip.bind(t,a,i),onMouseLeave:t.hideTooltip.bind(t)})}),i=this.props.humans.map(function(e,a){return n.a.createElement("circle",{cx:e[0]/t.props.ratio,cy:e[1]/t.props.ratio,r:"3",fill:"red",key:a})}),o=this.props.humans.map(function(e,a){return n.a.createElement(w.DraggableCore,{onStart:t.handleStart.bind(t,a),onDrag:t.handleDrag.bind(t,a),onStop:t.handleStop.bind(t,a),key:a},n.a.createElement("div",{className:"human",style:{top:e[1]-15,left:e[0]-15}}))}),s={};return s=this.state.left?{top:"0",left:"0"}:{top:"0",right:"0"},n.a.createElement("div",{className:"visibilitymap"},n.a.createElement("svg",{version:"1.1",viewBox:"0 0 ".concat(this.props.width," ").concat(this.props.height),ref:function(e){return t.container=e}},n.a.createElement("path",{d:this.state.shaded,fill:"#7693D3",stroke:"none"}),n.a.createElement("path",{d:this.buildings,fillRule:"evenodd",fill:"rgba(0, 0, 0, .05)",stroke:"rgba(60, 60, 60)",strokeWidth:".5"}),n.a.createElement("g",null,a),i),o,n.a.createElement("div",{className:this.state.tooltip?"tooltip":"hide",style:s},n.a.createElement("div",{className:"tooltip-title"},this.state.info)))}}]),e}(n.a.Component),z=function(t){function e(t){var a;return Object(p.a)(this,e),(a=Object(d.a)(this,Object(u.a)(e).call(this,t))).showTooltip=function(t,e){var i=e.target.getBBox();i.x+i.width/2>=a.props.width/2?a.setState({left:!0}):a.setState({left:!1}),a.setState({tooltip:!0,info:t})},a.hideTooltip=function(){a.setState({tooltip:!1,info:{}})},a.state={tooltip:!1,info:{},left:!0},a}return Object(m.a)(e,t),Object(h.a)(e,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var t=this,e=[],a=this.props,i=a.width,o=a.height,s=this.props.selected,r=this.props.longLinks,l=this.props.shortLinks,c=this.state.info;"Short Links"===this.props.option&&e.push(l.map(function(t){return n.a.createElement("line",{x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2,stroke:"rgba(205, 0, 255, .3)",strokeWidth:".5",key:"".concat(t.x1," ").concat(t.y1," ").concat(t.x2," ").concat(t.y2)})})),"Long Links"===this.props.option&&e.push(r.map(function(t){return n.a.createElement("line",{x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2,stroke:"rgba(205, 0, 255, .3)",strokeWidth:".5",key:"".concat(t.x1," ").concat(t.y1," ").concat(t.x2," ").concat(t.y2)})})),e.push(s.map(function(e){return n.a.createElement("circle",{cx:e.x,cy:e.y,r:2+e.shortLink/20*t.props.lengthratio,fill:"blue",key:"".concat(e.x," ").concat(e.y),onMouseEnter:t.showTooltip.bind(t,e.tag),onMouseLeave:t.hideTooltip.bind(t)})}));var p=[];for(var h in c)if("building"!==h||"yes"!==c[h]){var d=h.charAt(0).toUpperCase()+h.substr(1).toLowerCase();p.push(n.a.createElement("div",{className:"tooltip-info",key:h},n.a.createElement("span",{className:"tooltip-key"},d,": "),c[h]," ","Footprint"===d?decodeURI("m%C2%B2"):""))}var u={};return u=this.state.left?{top:"0",left:"0"}:{top:"0",right:"0"},n.a.createElement("div",{className:"nollimap"},n.a.createElement("svg",{version:"1.1",viewBox:"0 0 ".concat(i," ").concat(o),style:{width:this.state.width}},e),n.a.createElement("div",{className:this.state.tooltip?"tooltip":"hide",style:u},n.a.createElement("div",{className:"tooltip-title"},"Node Details"),p))}}]),e}(n.a.Component),F=function(t){function e(t){var a;return Object(p.a)(this,e),(a=Object(d.a)(this,Object(u.a)(e).call(this,t))).getElementCat=function(t){var e={water:[],waterway:["riverbank"],natural:["water","wetland","glacier","bay","strait"],landuse:["basin","reservoir"],leisure:["water_park","swimming_pool","swimming_area","marina","fishing"]},a={natural:["wood","tree_row","scrub","heath","moor","grassland"],landuse:["allotments","farmland","farmyard","forest","grass","greenfield","greenhouse_horticulture","meadow","orchard","plant_nursery","recreation_ground","village_green","vineyard"],leisure:["park","garden","golf_course","dog_park","pitch","track"]};for(var i in e)if(-1!=e[i].indexOf(t[i])||null!=t[i]&&0===e[i].length)return"water";for(i in a)if(-1!=a[i].indexOf(t[i])||t[i]&&0===a[i].length)return"green";return"none"},a.showTooltip=function(t,e){var i=e.target.getBBox();i.x+i.width/2>=a.props.width/2?a.setState({left:!0}):a.setState({left:!1}),a.setState({tooltip:!0,info:t})},a.hideTooltip=function(){a.setState({tooltip:!1,info:{}})},a.state={tooltip:!1,info:{},left:!0},a}return Object(m.a)(e,t),Object(h.a)(e,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var t=[],e=this.props,a=e.width,i=e.height,o=(e.nodes,e.ways),s=e.relations,r=this.state.info,l=[{fill:"#7693d3"},{fill:"rgba(52, 168, 0, .4)"}],c="none",p=-1;for(var h in s)if(p=-1,"water"===(c=this.getElementCat(s[h].tag))?p=0:"green"===c&&(p=1),-1!=p){var d="";s[h].members.forEach(function(t){if("way"===t.type&&t.value){var e=t.value.map(function(t){return t.join(",")}).join(" ");d+="M ".concat(e)}}),"water"===c?t.push(n.a.createElement("path",{d:d,fillRule:"evenodd",fill:l[p].fill,stroke:"white",strokeWidth:".5",key:h,className:"nolli-building",onMouseEnter:this.showTooltip.bind(this,s[h].tag),onMouseLeave:this.hideTooltip.bind(this)},n.a.createElement("title",null,h))):t.unshift(n.a.createElement("path",{d:d,fillRule:"evenodd",fill:l[p].fill,stroke:"white",strokeWidth:".5",key:h,className:"nolli-building",onMouseEnter:this.showTooltip.bind(this,s[h].tag),onMouseLeave:this.hideTooltip.bind(this)},n.a.createElement("title",null,h)))}for(h in o)if(p=-1,"water"===(c=this.getElementCat(o[h].tag))?p=0:"green"===c&&(p=1),-1!=p){var u=o[h].points.map(function(t){return t.join(",")}).join(" ");"water"===c?t.push(n.a.createElement("polygon",{points:u,fill:l[p].fill,stroke:"white",strokeWidth:".5",key:h,className:"nolli-building",onMouseEnter:this.showTooltip.bind(this,o[h].tag),onMouseLeave:this.hideTooltip.bind(this)})):t.unshift(n.a.createElement("polygon",{points:u,fill:l[p].fill,stroke:"white",strokeWidth:".5",key:h,className:"nolli-building",onMouseEnter:this.showTooltip.bind(this,o[h].tag),onMouseLeave:this.hideTooltip.bind(this)}))}var m=[];for(var g in r)if("building"!==g||"yes"!==r[g]){var f=g.charAt(0).toUpperCase()+g.substr(1).toLowerCase();m.push(n.a.createElement("div",{className:"tooltip-info",key:g},n.a.createElement("span",{className:"tooltip-key"},f,": "),r[g]," ","Footprint"===f?decodeURI("m%C2%B2"):""))}var v={};return v=this.state.left?{top:"0",left:"0"}:{top:"0",right:"0"},n.a.createElement("div",{className:"nollimap"},n.a.createElement("svg",{version:"1.1",viewBox:"0 0 ".concat(a," ").concat(i),style:{width:this.state.width}},t),n.a.createElement("div",{className:this.state.tooltip?"tooltip":"hide",style:v},n.a.createElement("div",{className:"tooltip-title"},"Details"),m))}}]),e}(n.a.Component),Y=function(t){function e(t){var i;return Object(p.a)(this,e),(i=Object(d.a)(this,Object(u.a)(e).call(this,t))).resize=function(){i.setState({pixratio:i.container.offsetWidth/i.state.width})},i.getDistance=function(t,e,a,i){var n=t*Math.PI/180,o=a*Math.PI/180,s=(a-t)*Math.PI/180,r=(i-e)*Math.PI/180,l=Math.sin(s/2)*Math.sin(s/2)+Math.cos(n)*Math.cos(o)*Math.sin(r/2)*Math.sin(r/2);return 6371e3*(2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l)))},i.getDirDistance=function(t,e,a,n){return a<=t&&n>=e?i.getDistance(t,e,a,n):-i.getDistance(t,e,a,n)},i.getBoundArea=function(t,e,a,n){return i.getDistance(t,a,t,n)*i.getDistance(t,a,e,a)},i.checkSingle=function(t){return Array.isArray(t)?t:t?[t]:[]},i.getWayPoints=function(t){var e="";return t.forEach(function(t){e+="".concat(t.x,",").concat(t.y," ")}),e},i.mapPix=function(t,e,a,i,n){return i+(t-e)*(n-i)/(a-e)},i.addLoading=function(t){i.setState({loading:i.state.loading+t})},i.resetLoading=function(){i.setState({loading:0})},i.updateStates=function(){var t=i.props,e=t.nlat,n=t.slat,o=t.wlng,s=t.elng,r=t.rawdata,l=i.state.width,c=l/i.getDistance(e,o,e,s),p=i.getDistance(e,o,n,o)*c,h={},d={},u={};if(r){var m=a(186).xml2js(r,{compact:!0,spaces:4}),g=i.checkSingle(m.osm.node),f=i.checkSingle(m.osm.way),v=i.checkSingle(m.osm.relation);g.forEach(function(t){var a=t._attributes.id,r=i.checkSingle(t.tag);h[a]={element:t},h[a].x=i.mapPix(t._attributes.lon,o,s,0,l),h[a].y=i.mapPix(t._attributes.lat,e,n,0,p),h[a].tag={},r.forEach(function(t){h[a].tag[t._attributes.k]=t._attributes.v})}),f.forEach(function(t){var e=t._attributes.id,a=i.checkSingle(t.nd),n=i.checkSingle(t.tag);if(d[e]={element:t},d[e].children=[],d[e].points=[],d[e].tag={},a.forEach(function(t){d[e].children.push(h[t._attributes.ref]),d[e].points.push([h[t._attributes.ref].x,h[t._attributes.ref].y])}),n.forEach(function(t){d[e].tag[t._attributes.k]=t._attributes.v}),d[e].tag.building){var o=i.getArea(d[e].points)/c/c;d[e].footprint=o,d[e].tag.footprint=o.toFixed(2)}}),v.forEach(function(t){var e=t._attributes.id,a=i.checkSingle(t.member),n=i.checkSingle(t.tag);if(u[e]={element:t},u[e].members=[],u[e].tag={},a.forEach(function(t){"way"===t._attributes.type&&d[t._attributes.ref]?u[e].members.push({type:"way",value:d[t._attributes.ref].points,role:t._attributes.role}):"node"===t._attributes.type&&h[t._attributes.ref]?u[e].members.push({type:"node",value:[h[t._attributes.ref].x,h[t._attributes.ref].y],role:t._attributes.role}):"relation"===t._attributes.type&&u[t._attributes.ref]&&u[e].members.push({type:"relation",value:u[t._attributes.ref].members,role:t._attributes.role})}),n.forEach(function(t){u[e].tag[t._attributes.k]=t._attributes.v}),u[e].tag.building||u[e].tag["buidling:part"]){var o=0;u[e].members.forEach(function(t){"outer"===t.role?o+=i.getArea(t.value):"outer"===t.role&&(o-=i.getArea(t.value))}),o=o/c/c,u[e].footprint=o,u[e].tag.footprint=o.toFixed(2)}})}var b=[],y=[],w=[],E=["waste_basket","waste_disposal","waste_transfer_station","recycling"];for(var k in h)null!=h[k].tag.amenity&&-1===E.indexOf(h[k].tag.amenity)&&(h[k].longLink=0,h[k].shortLink=0,b.push(h[k]));for(var x=0;x<b.length;x++)for(var N=x+1;N<b.length;N++){var M=Math.sqrt(_(b[x].x,b[x].y,b[N].x,b[N].y))/c;M<=150&&(b[x].longLink++,b[N].longLink++,w.push({x1:b[x].x,y1:b[x].y,x2:b[N].x,y2:b[N].y}),M<=100&&(b[x].shortLink++,b[N].shortLink++,y.push({x1:b[x].x,y1:b[x].y,x2:b[N].x,y2:b[N].y})))}i.ratio=c,i.selected=b,i.longLinks=w,i.shortLinks=y,i.setState({height:p,nodes:h,ways:d,relations:u,humans:[[Math.random()*l*i.container.offsetWidth/l,Math.random()*p*i.container.offsetWidth/l]],pixratio:i.container.offsetWidth/l}),i.addLoading(50)},i.getOptions=function(){var t=a(204)[i.props.selected],e=i.state.options[i.props.selected],o=[];return t&&(o.push(n.a.createElement("div",{className:"options-title",key:"title"},t.title)),t.options.forEach(function(t){o.push(n.a.createElement("div",{className:t===e?"options-item selected":"options-item",onClick:function(){i.setOption(t)},key:t},t))})),"Visibility"===i.props.selected&&(o.push(n.a.createElement("div",{className:"options-title",key:"title"},"You can add up to 5 viewing points:")),o.push(n.a.createElement("button",{className:"options-button",onClick:i.addHuman,key:"add",disabled:i.state.arcs.length>=5},"Add a Point")),o.push(n.a.createElement("button",{className:"options-button",onClick:i.deleteHuman,key:"delete",disabled:i.state.arcs.length<=1},"Delete a Point"))),o},i.setOption=function(t){var e=i.state.options;e[i.props.selected]=t,i.setState({options:e})},i.setPos=function(t,e){var a=i.state.humans;a[t]=e,i.setState({humans:a})},i.setArc=function(t,e){var a=i.state.arcs;a[t]=e,i.setState({arc:a})},i.setRegion=function(t,e){var a=i.state.regions;a[t]=e,i.setState({regions:a})},i.setArcs=function(t){i.setState({arc:t})},i.setRegions=function(t){i.setState({regions:t})},i.addHuman=function(){var t=i.state.humans,e=i.state.arcs,a=i.state.regions;t.push([Math.random()*i.state.width*i.state.pixratio,Math.random()*i.state.height*i.state.pixratio]),e.push(0),a.push(""),i.setState({humans:t,arcs:e,regions:a})},i.deleteHuman=function(){var t=i.state.humans,e=i.state.arcs,a=i.state.regions;t.pop(),e.pop(),a.pop(),i.setState({humans:t,arcs:e,regions:a})},i.state={loading:0,width:1e3,height:0,nodes:{},ways:{},relations:{},humans:[[500,250]],arcs:[0],regions:[""],options:{"POI Map":"Short Links","Nolli Map":"None",Visibility:"Both",Traffic:"Both","Natural Elements":""},pixratio:1},i}return Object(m.a)(e,t),Object(h.a)(e,[{key:"componentDidMount",value:function(){this.updateStates(),window.addEventListener("resize",this.resize)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.resize)}},{key:"componentDidUpdate",value:function(t){this.props.rawdata!==t.rawdata&&(this.resetLoading(),this.updateStates())}},{key:"getArea",value:function(t){var e=t,a=0;if(e.length<3)return 0;for(var i=0;i<e.length-1;i+=1)a+=e[i][0]*e[i+1][1]-e[i+1][0]*e[i][1];return Math.abs(1*a/2)}},{key:"render",value:function(){var t=this,e=this.getOptions(),a=this.state,i=a.ways,o=a.nodes,s=a.relations,r=a.width,l=a.height,c={},p=[];for(var h in c["POI Map"]=n.a.createElement(z,{nodes:o,ways:i,relations:s,width:r,height:l,getWayPoints:this.getWayPoints,addLoading:this.addLoading,nlat:this.props.nlat,slat:this.props.slat,wlng:this.props.wlng,elng:this.props.elng,option:this.state.options["POI Map"],key:"POI Map",lengthratio:this.ratio,selected:this.selected,longLinks:this.longLinks,shortLinks:this.shortLinks}),c["Nolli Map"]=n.a.createElement(T,{nodes:o,ways:i,relations:s,width:r,height:l,getWayPoints:this.getWayPoints,addLoading:this.addLoading,nlat:this.props.nlat,slat:this.props.slat,wlng:this.props.wlng,elng:this.props.elng,option:this.state.options["Nolli Map"],lengthratio:this.ratio,key:"Nolli Map"}),c.Visibility=n.a.createElement(I,{nodes:o,ways:i,relations:s,width:r,height:l,humans:this.state.humans,arcs:this.state.arcs,regions:this.state.regions,setPos:this.setPos,setArc:this.setArc,setRegion:this.setRegion,setArcs:this.setArcs,setRegions:this.setRegions,addLoading:this.addLoading,nlat:this.props.nlat,slat:this.props.slat,wlng:this.props.wlng,elng:this.props.elng,key:"Visibility",option:this.state.options.Traffic,ratio:this.state.pixratio,lengthratio:this.ratio}),c.Traffic=n.a.createElement(D,{nodes:o,ways:i,relations:s,width:r,height:l,getWayPoints:this.getWayPoints,addLoading:this.addLoading,nlat:this.props.nlat,slat:this.props.slat,wlng:this.props.wlng,elng:this.props.elng,key:"Traffic",option:this.state.options.Traffic,lengthratio:this.ratio}),c["Natural Elements"]=n.a.createElement(F,{nodes:o,ways:i,relations:s,width:r,height:l,getWayPoints:this.getWayPoints,addLoading:this.addLoading,nlat:this.props.nlat,slat:this.props.slat,wlng:this.props.wlng,elng:this.props.elng,option:this.state.options["Natural Elements"],key:"Natural Elements"}),this.props.added)this.props.added[h]&&p.unshift(c[h]);return n.a.createElement("div",{className:"maps-wrapper",ref:function(e){return t.container=e}},n.a.createElement("div",{className:"options"},e),n.a.createElement("div",{style:{width:"100%",height:"".concat(this.state.height*this.state.pixratio+200,"px")}}),n.a.createElement("div",{className:100===this.state.loading?"hide":"loading"},n.a.createElement("svg",{version:"1.1",x:"0px",y:"0px",viewBox:"0 0 110 110"},n.a.createElement("path",{id:"r5",d:"M37.2,39.9l5,8.7l19.1-11c1-0.6,1.3-1.8,0.7-2.7l-5-8.7l-19.1,11 C37,37.8,36.6,39,37.2,39.9z"}),n.a.createElement("path",{id:"r3",d:"M108,70.6c1-0.6,1.3-1.8,0.7-2.7l-31-53.7l-17.3,10l5,8.7c1.7,2.9,0.7,6.5-2.2,8.2 l-19.1,11l4,6.9l12.1-7c2.9-1.7,6.5-0.7,8.2,2.2l17,29.4L108,70.6z"}),n.a.createElement("path",{id:"r7",d:"M62.3,55.5l-12.1,7l18,31.2l13.9-8L65,56.2C64.5,55.2,63.3,54.9,62.3,55.5z"}),n.a.createElement("rect",{id:"r6",x:"16.6",y:"60.5",transform:"matrix(0.866 -0.5 0.5 0.866 -28.17 23.9398)",width:"28",height:"8"}),n.a.createElement("path",{id:"r1",d:"M58.4,20.8l17.3-10l-5-8.7c-0.6-1-1.8-1.3-2.7-0.7l-15.6,9L58.4,20.8z"}),n.a.createElement("path",{id:"r2",d:"M42.2,108.6l22.5-13l-18-31.2l-24.2,14l17,29.4C40,108.9,41.2,109.2,42.2,108.6z"}),n.a.createElement("path",{id:"r4",d:"M2.2,39.4c-1,0.6-1.3,1.8-0.7,2.7l13,22.5l24.2-14l-5-8.7c-1.7-2.9-0.7-6.5,2.2-8.2 l19.1-11l-6-10.4L2.2,39.4z"})),"Loading"),"Overlay"===this.props.selected?p:c[this.props.selected])}}]),e}(n.a.Component),X=(a(205),function(t){function e(t){var a;return Object(p.a)(this,e),(a=Object(d.a)(this,Object(u.a)(e).call(this,t))).changeMap=function(t){a.props.foldSidebar(),a.props.changeMap(t)},a.addOverlay=function(t,e){t.stopPropagation(),a.props.addOverlay(e)},a.removeOverlay=function(t,e){t.stopPropagation(),a.props.removeOverlay(e)},a.handleUpdate=function(t,e){console.log(t),console.log(e)},a.renderMenu=function(){var t=a.props,e=t.layers,i=t.added,o=t.selected,s=[];return e.forEach(function(t,e){s.push(n.a.createElement("div",{className:t===o?"menu-item selected":"menu-item",key:"".concat(t),onClick:function(){return a.changeMap(t)}},n.a.createElement("img",{className:"menu-icon",src:"".concat("/infomap","/image/icon/").concat(t,".svg"),alt:"menu"}),n.a.createElement("div",{className:"menu-title"},t),i[t]?n.a.createElement("img",{className:"check-box",src:"".concat("/infomap","/image/icon/check.svg"),onClick:function(e){return a.removeOverlay(e,t)},alt:"add"}):n.a.createElement("img",{className:"check-box",src:"".concat("/infomap","/image/icon/uncheck.svg"),onClick:function(e){return a.addOverlay(e,t)},alt:"delete"})))}),s},a.state={menu:a.props.layers,added:a.props.added,selected:a.props.selected},a}return Object(m.a)(e,t),Object(h.a)(e,[{key:"render",value:function(){var t=this,e=this.renderMenu(),a=0;for(var i in this.props.added)this.props.added[i]&&a++;return n.a.createElement("div",{className:"menu",style:this.props.style},n.a.createElement("div",{className:"footer-wrapper"},n.a.createElement("img",{className:"logo",src:"/infomap/image/infomap-logo.svg",alt:"infomap"}),n.a.createElement(g.a,{to:"".concat("/infomap","/").concat(this.props.longitude,"/").concat(this.props.latitude)},n.a.createElement("div",{className:"back"},n.a.createElement("img",{className:"back-icon",src:"/infomap/image/icon/back.svg",alt:"back"}),"Change Location")),e,n.a.createElement("div",{className:"divider"}),n.a.createElement("div",{className:"Overlay"===this.props.selected?"menu-item selected":"menu-item",onClick:function(){return t.changeMap("Overlay")}},n.a.createElement("img",{className:"menu-icon",src:"".concat("/infomap","/image/icon/Overlay.svg"),alt:"menu"}),n.a.createElement("div",{className:"menu-title"},"Overlay"),n.a.createElement("div",{className:"number"},a)),n.a.createElement("div",{className:"push"})),n.a.createElement("div",{className:"sidebar-footer"},n.a.createElement("div",{className:"footer-tab"},"About"),n.a.createElement("div",{className:"footer-tab"},"Help")))}}]),e}(n.a.Component)),V=Object(y.a)(X),U=(a(208),function(t){function e(t){var a;return Object(p.a)(this,e),(a=Object(d.a)(this,Object(u.a)(e).call(this,t))).resize=function(){a.setState({width:window.innerWidth}),window.innerWidth>768&&a.setState({sidebar:!1})},a.changeMap=function(t){a.setState({selected:t})},a.addOverlay=function(t){var e=a.state.added;e[t]=!0,a.setState({added:e})},a.removeOverlay=function(t){var e=a.state.added;e[t]=!1,a.setState({added:e})},a.expandSidebar=function(){a.setState({sidebar:!0})},a.foldSidebar=function(){a.setState({sidebar:!1})},a.state={raw:null,layers:["POI Map","Nolli Map","Visibility","Traffic","Natural Elements"],added:{"POI Map":!0,"Nolli Map":!0,Visibility:!1,Traffic:!1,"Natural Elements":!1},selected:"Nolli Map",sidebar:!1,width:window.innerWidth},a.bounds=a.props.match.params,a}return Object(m.a)(e,t),Object(h.a)(e,[{key:"componentDidMount",value:function(){var t=this;j.a.get("https://api.openstreetmap.org/api/0.6/map?bbox=".concat(this.bounds.wlng,",").concat(this.bounds.slat,",").concat(this.bounds.elng,",").concat(this.bounds.nlat)).then(function(e){e.data&&t.setState({raw:e.data})}),window.addEventListener("resize",this.resize)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.resize)}},{key:"render",value:function(){var t=(parseFloat(this.bounds.wlng)+parseFloat(this.bounds.elng))/2,e=(parseFloat(this.bounds.nlat)+parseFloat(this.bounds.slat))/2,a={left:0};return window.innerWidth<768&&!this.state.sidebar&&(a={left:-250}),n.a.createElement("div",{className:"maps"},n.a.createElement(V,{style:a,layers:this.state.layers,added:this.state.added,selected:this.state.selected,changeMap:this.changeMap,addOverlay:this.addOverlay,removeOverlay:this.removeOverlay,foldSidebar:this.foldSidebar,longitude:t,latitude:e}),n.a.createElement("div",{className:"map-display"},n.a.createElement(Y,Object.assign({layers:this.state.layers,added:this.state.added,selected:this.state.selected},this.props.match.params,{rawdata:this.state.raw}))),n.a.createElement("div",{className:"navbar"},n.a.createElement("img",{className:"icon",src:"/infomap/image/icon/menu.svg",onClick:this.expandSidebar,alt:"menu"}),n.a.createElement("img",{className:"logo",src:"/infomap/image/infomap-logo.svg",alt:"infomap"})),n.a.createElement("div",{className:this.state.sidebar?"mask":"hide",onClick:this.foldSidebar}),n.a.createElement("div",{className:"raw hide"},n.a.createElement("div",null,"n: ".concat(this.bounds.nlat," s: ").concat(this.bounds.slat," w: ").concat(this.bounds.wlng," e: ").concat(this.bounds.elng)),n.a.createElement("div",null,"API address: ","https://api.openstreetmap.org/api/0.6/map?bbox=".concat(this.bounds.wlng,",").concat(this.bounds.slat,",").concat(this.bounds.elng,",").concat(this.bounds.nlat))))}}]),e}(n.a.Component)),H=function(t){function e(){return Object(p.a)(this,e),Object(d.a)(this,Object(u.a)(e).apply(this,arguments))}return Object(m.a)(e,t),Object(h.a)(e,[{key:"componentDidUpdate",value:function(t){this.props.location!==t.location&&window.scrollTo(0,0)}},{key:"render",value:function(){return this.props.children}}]),e}(n.a.Component),q=Object(y.a)(H);a(211),a(214);s.a.render(n.a.createElement(r.a,null,n.a.createElement(q,null,n.a.createElement(l.a,{exact:!0,path:"/infomap/",component:N}),n.a.createElement(l.a,{exact:!0,path:"/infomap/:lng/:lat",component:N}),n.a.createElement(l.a,{exact:!0,path:"/infomap/help",component:M}),n.a.createElement(l.a,{exact:!0,path:"/infomap/about",component:O}),n.a.createElement(l.a,{exact:!0,path:"/infomap/selected/:wlng/:slat/:elng/:nlat",component:U}))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){t.unregister()})}},[[104,2,1]]]);
//# sourceMappingURL=main.1933c9c8.chunk.js.map