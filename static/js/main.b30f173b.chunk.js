(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{120:function(e,t,a){e.exports=a(255)},125:function(e,t,a){},133:function(e,t,a){},246:function(e,t,a){},249:function(e,t,a){},252:function(e,t,a){},255:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),s=a(44),c=a.n(s),i=a(261),r=a(131);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var l=a(5),p=a(4),d=a(7),m=a(6),h=a(8),u=a(128),v=a(257),g=(a(125),function(e){function t(){return Object(l.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return o.a.createElement("div",{className:"navbar-wrapper"},o.a.createElement("div",{className:"navbar-logo"},o.a.createElement(u.a,{to:"/infomap/"},o.a.createElement("img",{style:{height:40},src:"/infomap/image/logo.svg",alt:"Infomap Logo"}))),o.a.createElement("div",{className:"navbar-tabs"},o.a.createElement(v.a,{className:"navbar-tabitem",activeClassName:"navbar-tabitem-active",to:"/infomap/demo"},"Demo"),o.a.createElement(v.a,{className:"navbar-tabitem",activeClassName:"navbar-tabitem-active",to:"/infomap/about"},"About"),o.a.createElement(v.a,{className:"navbar-tabitem",activeClassName:"navbar-tabitem-active",to:"/infomap/help"},"Help")))}}]),t}(o.a.Component)),b=(a(133),a(77)),f=a(54),y=a(115),E=a.n(y),w=a(260),O=a(35),x=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(d.a)(this,Object(m.a)(t).call(this,e))).updateWindowDimensions=function(){a.setState({width:.833333*window.innerWidth})},a.updateXY=function(e,t,n){var o=n.deltaX,s=n.deltaY;"1"===e?a.props.x+o>=40&&a.props.x+o<=a.state.width/2-40&&a.props.y+s>=60&&a.props.y+s<=a.state.height/2-40&&a.props.setXY({x:a.props.x+o,y:a.props.y+s}):"2"===e?a.props.x-o>=40&&a.props.x-o<=a.state.width/2-40&&a.props.y+s>=60&&a.props.y+s<=a.state.height/2-40&&a.props.setXY({x:a.props.x-o,y:a.props.y+s}):"3"===e?a.props.x+o>=40&&a.props.x+o<=a.state.width/2-40&&a.props.y-s>=60&&a.props.y-s<=a.state.height/2-40&&a.props.setXY({x:a.props.x+o,y:a.props.y-s}):"4"===e&&a.props.x-o>=40&&a.props.x-o<=a.state.width/2-40&&a.props.y-s>=60&&a.props.y-s<=a.state.height/2-40&&a.props.setXY({x:a.props.x-o,y:a.props.y-s})},a.handleStart=function(e,t,n){var o=n.deltaX,s=n.deltaY;a.props.setDragging(!0),a.updateXY(e,t,{deltaX:o,deltaY:s})},a.handleStop=function(e,t,n){var o=n.deltaX,s=n.deltaY;a.props.setDragging(!1),a.updateXY(e,t,{deltaX:o,deltaY:s})},a.handleDrag=function(e,t,n){var o=n.deltaX,s=n.deltaY;a.updateXY(e,t,{deltaX:o,deltaY:s})},a.state={width:0,height:600,dragging:!1},a}return Object(h.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){this.updateWindowDimensions(),window.addEventListener("resize",this.updateWindowDimensions)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.updateWindowDimensions)}},{key:"render",value:function(){var e=this.state.width,t=this.state.height;return o.a.createElement("div",{className:"selector"},o.a.createElement("div",{className:"shader",style:{position:"absolute",left:0,top:0,height:"".concat(t,"px"),width:"".concat(this.props.x,"px")}}),o.a.createElement("div",{className:"shader",style:{position:"absolute",left:"".concat(e-this.props.x,"px"),top:0,height:"".concat(t,"px"),width:"".concat(this.props.x,"px")}}),o.a.createElement("div",{className:"shader",style:{position:"absolute",left:"".concat(this.props.x,"px"),top:0,height:"".concat(this.props.y,"px"),width:"".concat(e-2*this.props.x,"px")}}),o.a.createElement("div",{className:"shader",style:{position:"absolute",left:"".concat(this.props.x,"px"),top:"".concat(t-this.props.y,"px"),height:"".concat(this.props.y,"px"),width:"".concat(e-2*this.props.x,"px")}}),o.a.createElement(O.DraggableCore,{onStart:this.handleStart.bind(this,"1"),onDrag:this.handleDrag.bind(this,"1"),onStop:this.handleStop.bind(this,"1")},o.a.createElement("div",{className:"handler",style:{top:this.props.y-6,left:this.props.x-6}})),o.a.createElement(O.DraggableCore,{onStart:this.handleStart.bind(this,"2"),onDrag:this.handleDrag.bind(this,"2"),onStop:this.handleStop.bind(this,"2")},o.a.createElement("div",{className:"handler",style:{top:this.props.y-6,left:e-this.props.x-6}})),o.a.createElement(O.DraggableCore,{onStart:this.handleStart.bind(this,"3"),onDrag:this.handleDrag.bind(this,"3"),onStop:this.handleStop.bind(this,"3")},o.a.createElement("div",{className:"handler",style:{top:t-this.props.y-6,left:this.props.x-6}})),o.a.createElement(O.DraggableCore,{onStart:this.handleStart.bind(this,"4"),onDrag:this.handleDrag.bind(this,"4"),onStop:this.handleStop.bind(this,"4")},o.a.createElement("div",{className:"handler",style:{top:t-this.props.y-6,left:e-this.props.x-6}})))}}]),t}(n.Component),j="pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4M29iazA2Z2gycXA4N2pmbDZmangifQ.-g_vE53SD2WrJ6tFX7QHmA",N=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(d.a)(this,Object(m.a)(t).call(this,e))).resize=function(){a.setState({width:.833333*window.innerWidth}),a.handleViewportChange({width:"100%"})},a.handleViewportChange=function(e){if(!1===a.state.isdragging&&(a.setState({viewport:Object(b.a)({},a.state.viewport,e)}),a.mapRef.current)){var t=a.mapRef.current.getMap().getBounds();a.setState({selBounds:{n:t._ne.lat,s:t._sw.lat,w:t._sw.lng,e:t._ne.lng}})}},a.handleOnResult=function(e){console.log(e.result)},a.handleGeocoderViewportChange=function(e){console.log(e),a.handleViewportChange(Object(b.a)({},e,{transitionDuration:100}))},a.setDragging=function(e){a.setState({isdragging:e})},a.setXY=function(e){a.setState({selector:e})},a.getDistance=function(e,t,a,n){var o=e*Math.PI/180,s=a*Math.PI/180,c=(a-e)*Math.PI/180,i=(n-t)*Math.PI/180,r=Math.sin(c/2)*Math.sin(c/2)+Math.cos(o)*Math.cos(s)*Math.sin(i/2)*Math.sin(i/2);return 6371e3*(2*Math.atan2(Math.sqrt(r),Math.sqrt(1-r)))},a.getBoundArea=function(e,t,n,o){return a.getDistance(e,n,e,o)*a.getDistance(e,n,t,n)},a.state={viewport:{width:"100%",height:"600px",latitude:37.7577,longitude:-122.4376,zoom:16},searchResultLayer:null,selector:{x:0,y:0},isdragging:!1,selBounds:{n:0,s:0,w:0,e:0},width:0},a.mapRef=o.a.createRef(),a}return Object(h.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this.resize),this.resize();var e=this.mapRef.current.getMap().getBounds();this.setState({selBounds:{n:e._ne.lat,s:e._sw.lat,w:e._sw.lng,e:e._ne.lng},selector:{x:.833333*window.innerWidth/4,y:150}})}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.resize)}},{key:"render",value:function(){var e=this.state,t=e.viewport,a=(e.searchResultLayer,e.selector),n=e.selBounds,s=n.n-a.y/600*(n.n-n.s),c=n.s+a.y/600*(n.n-n.s),i=n.w+a.x/this.state.width*(n.e-n.w),r=n.e-a.x/this.state.width*(n.e-n.w),l=this.getBoundArea(s,c,i,r).toFixed(2),p=this.props.location.pathname==="".concat("/infomap","/demo");return o.a.createElement("div",null,o.a.createElement(f.default,Object.assign({className:"map",ref:this.mapRef},t,{onViewportChange:this.handleViewportChange,mapboxApiAccessToken:j,mapStyle:"mapbox://styles/mapbox/streets-v9"}),o.a.createElement(E.a,{mapRef:this.mapRef,onResult:this.handleOnResult,onViewportChange:this.handleGeocoderViewportChange,mapboxApiAccessToken:j,position:"top-left"}),o.a.createElement("div",{className:"control"},o.a.createElement(f.NavigationControl,{showCompass:!1,onViewportChange:this.handleViewportChange})),o.a.createElement(x,Object.assign({},a,{setDragging:this.setDragging,setXY:this.setXY}))),l<=1e6?o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"area-indicator"},o.a.createElement("div",{className:"area-indicator-fill",style:{width:l/1e6*200}})),o.a.createElement("div",{className:"area-number"},"Area: ",l," m \xb2"),p?o.a.createElement(u.a,{to:"".concat("/infomap","/demo/selected")},o.a.createElement("div",{className:"button proceed-button"},"Proceed to Analysis ")):o.a.createElement(u.a,{to:"".concat("/infomap","/selected/").concat(i,"/").concat(c,"/").concat(r,"/").concat(s)},o.a.createElement("div",{className:"button proceed-button"},"Proceed to Analysis ")),o.a.createElement("div",{className:"proceed-alert green"}," You can use this selected region. ")):o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"area-indicator"},o.a.createElement("div",{className:"area-indicator-fill area-exceed",style:{width:200}})),o.a.createElement("div",{className:"area-number"},"Area: >1 km \xb2"),o.a.createElement("div",{className:"button button-disabled proceed-button"},"Proceed to Analysis "),o.a.createElement("div",{className:"proceed-alert red"}," Area of the selected region is too big. ")),o.a.createElement("div",{className:"clearfix"}),p?o.a.createElement("div",null):o.a.createElement("div",{className:"raw"},o.a.createElement("div",null,o.a.createElement("p",null,"Viewport Coordinates:"),o.a.createElement("p",null," ","n: ".concat(n.n," s: ").concat(n.s," w: ").concat(n.w," e: ").concat(n.e))),o.a.createElement("div",null,o.a.createElement("p",null,"Selected Region Coordinates:"),o.a.createElement("p",null," ","n: ".concat(s," s: ").concat(c," w: ").concat(i," e: ").concat(r))),o.a.createElement("div",null,o.a.createElement("p",null,"Selected Region Area:"),o.a.createElement("p",null," ",l))))}}]),t}(n.Component),S=Object(w.a)(N),C=function(e){function t(){return Object(l.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return o.a.createElement("div",{className:"content-wrapper"},o.a.createElement("div",{className:"title"},"Select an Area"),o.a.createElement(S,null))}}]),t}(o.a.Component),D=function(e){function t(){return Object(l.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement("div",null,"Help"))}}]),t}(o.a.Component),M=function(e){function t(){return Object(l.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement("div",null,"About"))}}]),t}(o.a.Component),k=a(117),X=a.n(k),Y=(a(198),function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(d.a)(this,Object(m.a)(t).call(this,e))).state={raw:null},a.bounds=a.props.match.params,a}return Object(h.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){var e=this;X.a.get("https://api.openstreetmap.org/api/0.6/map?bbox=".concat(this.bounds.wlng,",").concat(this.bounds.slat,",").concat(this.bounds.elng,",").concat(this.bounds.nlat)).then(function(t){t.data&&e.setState({raw:t.data})})}},{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement("div",null,"n: ".concat(this.bounds.nlat," s: ").concat(this.bounds.slat," w: ").concat(this.bounds.wlng," e: ").concat(this.bounds.elng)),o.a.createElement("div",null,"API address: ","https://api.openstreetmap.org/api/0.6/map?bbox=".concat(this.bounds.wlng,",").concat(this.bounds.slat,",").concat(this.bounds.elng,",").concat(this.bounds.nlat)),o.a.createElement("div",null,this.state.raw))}}]),t}(o.a.Component)),A=a(119),I=a(118),W=a.n(I),R=(a(246),function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(d.a)(this,Object(m.a)(t).call(this,e))).changeMap=function(e){a.props.changeMap(e)},a.addOverlay=function(e,t){e.stopPropagation(),a.props.addOverlay(t)},a.removeOverlay=function(e){a.props.removeOverlay(e)},a.setOverlay=function(e){a.props.setOverlay(e)},a.handleUpdate=function(e,t){console.log(e),console.log(t)},a.changeOpacity=function(e,t){a.props.setOpacity(t,e.currentTarget.value)},a.disableDrag=function(e){a.setState({draggable:!1})},a.enableDrag=function(e){a.setState({draggable:!0})},a.renderMenu=function(){var e=a.props.sidebar,t=a.props.selected,n=a.props.overlay.map(function(e){return e.name}),s=[],c=function(c){s.push(o.a.createElement("div",{className:c==t?"menu-item selected":"menu-item",key:"".concat(e[c]),onClick:function(){return a.changeMap(c)}},o.a.createElement("div",{className:"menu-title"},e[c]),-1!=n.indexOf(e[c])||"Overlay"==e[c]?o.a.createElement("div",null):o.a.createElement("svg",{version:"1.1",viewBox:"0 0 80 80",className:c==t?"icon selected":"icon",onClick:function(t){return a.addOverlay(t,e[c])}},o.a.createElement("path",{d:"M74,35H45V6c0-2.8-2.2-5-5-5s-5,2.2-5,5v29H6c-2.8,0-5,2.2-5,5c0,2.8,2.2,5,5,5h29v29c0,2.8,2.2,5,5,5s5-2.2,5-5V45h29 c2.8,0,5-2.2,5-5C79,37.2,76.8,35,74,35z"}))))};for(var i in e)c(i);return s},a.state={},a}return Object(h.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"menu"},this.renderMenu(),o.a.createElement(W.a,{className:"submenu",dataSource:this.props.overlay,row:function(t,a){return o.a.createElement("div",{className:"submenu-item",key:"".concat(t.name,"1")},o.a.createElement("div",{className:"submenu-title"},t.name),o.a.createElement("svg",{version:"1.1",viewBox:"0 0 80 80",className:"icon",onClick:function(){return e.removeOverlay(t)}},o.a.createElement("path",{id:"XMLID_6_",d:"M74,45H6c-2.8,0-5-2.2-5-5s2.2-5,5-5h68c2.8,0,5,2.2,5,5S76.8,45,74,45z"})),o.a.createElement("div",{className:"slider"},o.a.createElement("input",{type:"range",name:"opacity",min:"0",max:"100",onChange:function(a){return e.changeOpacity(a,t)},value:t.opacity}),o.a.createElement("div",{className:"slider-value"},t.opacity)),o.a.createElement("div",{className:"clearfix"}))},handles:!1,onUpdate:this.handleUpdate}))}}]),t}(o.a.Component)),z=Object(w.a)(R),B=(a(249),function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(d.a)(this,Object(m.a)(t).call(this,e))).changeMap=function(e){a.setState({selected:e})},a.addOverlay=function(e){a.setState({overlay:[{name:e,opacity:100}].concat(Object(A.a)(a.state.overlay))})},a.removeOverlay=function(e){var t=a.state.overlay.indexOf(e),n=a.state.overlay;n.splice(t,1),a.setState({overlay:n})},a.setOverlay=function(e){console.log(e),a.setState({overlay:e})},a.getShuffled=function(e){console.log(e),a.setState({shuffled:e})},a.setOpacity=function(e,t){var n=a.state.overlay.indexOf(e);console.log(n,t);var o=a.state.overlay;o[n]={name:e.name,opacity:parseInt(t)},a.setState({overlay:o})},a.renderLayers=function(){var e=a.state.overlay,t=[];for(var n in e)t.push(o.a.createElement("img",{key:e[n].name,style:{position:"absolute",maxWidth:"100%",opacity:e[n].opacity/100},src:"".concat("/infomap","/image/demo/").concat(e[n].name,".png"),alt:"".concat(e[n].name)}));return console.log(t),t.reverse()},a.state={sidebar:["Original","Nolli Map","Program","Traffic","POI Clustering","Overlay"],overlay:[{name:"Nolli Map",opacity:100}],shuffled:[{name:"Nolli Map",opacity:100}],selected:1},a}return Object(h.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this.state.sidebar[this.state.selected];return o.a.createElement("div",{className:"maps"},o.a.createElement("div",{className:"functions"},o.a.createElement(u.a,{to:"".concat("/infomap","/demo"),className:"back"},o.a.createElement("svg",{version:"1.1",viewBox:"0 0 80 80",className:"back-icon"},o.a.createElement("path",{id:"XMLID_7_",d:"M74,35H18.1l23.5-23.5c2-2,2-5.1,0-7.1c-2-2-5.1-2-7.1,0l-32,32c0,0,0,0,0,0C2.2,36.7,2,37,1.8,37.2 c-0.1,0.1-0.1,0.3-0.2,0.4c-0.1,0.2-0.2,0.3-0.2,0.5c-0.1,0.2-0.1,0.3-0.2,0.5c0,0.1-0.1,0.3-0.1,0.4c-0.1,0.6-0.1,1.3,0,2 c0,0.1,0.1,0.3,0.1,0.4c0.1,0.2,0.1,0.3,0.2,0.5c0.1,0.2,0.2,0.3,0.2,0.5c0.1,0.1,0.1,0.3,0.2,0.4C2,43,2.2,43.3,2.5,43.5l32,32 c1,1,2.3,1.5,3.5,1.5s2.6-0.5,3.5-1.5c2-2,2-5.1,0-7.1L18.1,45H74c2.8,0,5-2.2,5-5S76.8,35,74,35z"})),o.a.createElement("div",{className:"title"},"Change Location")),o.a.createElement("div",{className:"button export-button"},"Export This Mapping")),o.a.createElement("div",{className:"clearfix"}),o.a.createElement(z,Object.assign({},this.state,{changeMap:this.changeMap,addOverlay:this.addOverlay,removeOverlay:this.removeOverlay,setOverlay:this.setOverlay,setOpacity:this.setOpacity,getShuffled:this.getShuffled})),o.a.createElement("div",{className:"map-display"},"Overlay"!=e?o.a.createElement("img",{style:{position:"absolute",maxWidth:"100%"},src:"".concat("/infomap","/image/demo/").concat(e,".png"),alt:"selected"}):this.renderLayers()),o.a.createElement("div",{className:"clearfix"}))}}]),t}(o.a.Component)),L=function(e){function t(){return Object(l.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(p.a)(t,[{key:"componentDidUpdate",value:function(e){this.props.location!==e.location&&window.scrollTo(0,0)}},{key:"render",value:function(){return this.props.children}}]),t}(o.a.Component),V=Object(w.a)(L),_=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(d.a)(this,Object(m.a)(t).call(this,e))).state={},a}return Object(h.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return o.a.createElement("div",{className:"footer"},o.a.createElement("div",null,"Infomap v0.1.0 prototype \xa9 2018 Wu Chenmu"))}}]),t}(o.a.Component);a(252);c.a.render(o.a.createElement(i.a,null,o.a.createElement(V,null,o.a.createElement("div",{className:"content"},o.a.createElement(g,null),o.a.createElement(r.a,{exact:!0,path:"/infomap/",component:C}),o.a.createElement(r.a,{exact:!0,path:"/infomap/help",component:D}),o.a.createElement(r.a,{exact:!0,path:"/infomap/about",component:M}),o.a.createElement(r.a,{exact:!0,path:"/infomap/demo",component:C}),o.a.createElement(r.a,{exact:!0,path:"/infomap/selected/:wlng/:slat/:elng/:nlat",component:Y}),o.a.createElement(r.a,{exact:!0,path:"/infomap/demo/selected",component:B}),o.a.createElement(_,null)))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[120,2,1]]]);
//# sourceMappingURL=main.b30f173b.chunk.js.map